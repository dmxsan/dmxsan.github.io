var rt=Object.defineProperty;var G=a=>{throw TypeError(a)};var ot=(a,n,e)=>n in a?rt(a,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[n]=e;var A=(a,n,e)=>ot(a,typeof n!="symbol"?n+"":n,e),lt=(a,n,e)=>n.has(a)||G("Cannot "+e);var C=(a,n,e)=>(lt(a,n,"read from private field"),e?e.call(a):n.get(a)),X=(a,n,e)=>n.has(a)?G("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(a):n.set(a,e);import{z as ct,k as S,B as R,ae as Y,i as ut,C as dt,Q as ft,m as ht,af as pt,ag as yt,ab as gt,q as mt,b as M,ah as Z,ai as Ht,aj as vt,ak as wt,W as _t,S as $t,I as tt,e as Bt,F as et,am as bt}from"./DtbfG8E9.js";function At(a){return typeof a=="string"?`'${a}'`:new jt().serialize(a)}const jt=function(){var n;class a{constructor(){X(this,n,new Map)}compare(t,s){const i=typeof t,r=typeof s;return i==="string"&&r==="string"?t.localeCompare(s):i==="number"&&r==="number"?t-s:String.prototype.localeCompare.call(this.serialize(t,!0),this.serialize(s,!0))}serialize(t,s){if(t===null)return"null";switch(typeof t){case"string":return s?t:`'${t}'`;case"bigint":return`${t}n`;case"object":return this.$object(t);case"function":return this.$function(t)}return String(t)}serializeObject(t){const s=Object.prototype.toString.call(t);if(s!=="[object Object]")return this.serializeBuiltInType(s.length<10?`unknown:${s}`:s.slice(8,-1),t);const i=t.constructor,r=i===Object||i===void 0?"":i.name;if(r!==""&&globalThis[r]===i)return this.serializeBuiltInType(r,t);if(typeof t.toJSON=="function"){const o=t.toJSON();return r+(o!==null&&typeof o=="object"?this.$object(o):`(${this.serialize(o)})`)}return this.serializeObjectEntries(r,Object.entries(t))}serializeBuiltInType(t,s){const i=this["$"+t];if(i)return i.call(this,s);if(typeof(s==null?void 0:s.entries)=="function")return this.serializeObjectEntries(t,s.entries());throw new Error(`Cannot serialize ${t}`)}serializeObjectEntries(t,s){const i=Array.from(s).sort((o,c)=>this.compare(o[0],c[0]));let r=`${t}{`;for(let o=0;o<i.length;o++){const[c,y]=i[o];r+=`${this.serialize(c,!0)}:${this.serialize(y)}`,o<i.length-1&&(r+=",")}return r+"}"}$object(t){let s=C(this,n).get(t);return s===void 0&&(C(this,n).set(t,`#${C(this,n).size}`),s=this.serializeObject(t),C(this,n).set(t,s)),s}$function(t){const s=Function.prototype.toString.call(t);return s.slice(-15)==="[native code] }"?`${t.name||""}()[native]`:`${t.name}(${t.length})${s.replace(/\s*\n\s*/g,"")}`}$Array(t){let s="[";for(let i=0;i<t.length;i++)s+=this.serialize(t[i]),i<t.length-1&&(s+=",");return s+"]"}$Date(t){try{return`Date(${t.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(t){return`ArrayBuffer[${new Uint8Array(t).join(",")}]`}$Set(t){return`Set${this.$Array(Array.from(t).sort((s,i)=>this.compare(s,i)))}`}$Map(t){return this.serializeObjectEntries("Map",t.entries())}}n=new WeakMap;for(const e of["Error","RegExp","URL"])a.prototype["$"+e]=function(t){return`${e}(${t})`};for(const e of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])a.prototype["$"+e]=function(t){return`${e}[${t.join(",")}]`};for(const e of["BigInt64Array","BigUint64Array"])a.prototype["$"+e]=function(t){return`${e}[${t.join("n,")}${t.length>0?"n":""}]`};return a}(),St=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],zt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",j=[];class Et{constructor(){A(this,"_data",new O);A(this,"_hash",new O([...St]));A(this,"_nDataBytes",0);A(this,"_minBufferSize",0)}finalize(n){n&&this._append(n);const e=this._nDataBytes*8,t=this._data.sigBytes*8;return this._data.words[t>>>5]|=128<<24-t%32,this._data.words[(t+64>>>9<<4)+14]=Math.floor(e/4294967296),this._data.words[(t+64>>>9<<4)+15]=e,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(n,e){const t=this._hash.words;let s=t[0],i=t[1],r=t[2],o=t[3],c=t[4],y=t[5],u=t[6],_=t[7];for(let p=0;p<64;p++){if(p<16)j[p]=n[e+p]|0;else{const g=j[p-15],$=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,m=j[p-2],k=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;j[p]=$+j[p-7]+k+j[p-16]}const w=c&y^~c&u,D=s&i^s&r^i&r,b=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),U=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),E=_+U+w+zt[p]+j[p],T=b+D;_=u,u=y,y=c,c=o+E|0,o=r,r=i,i=s,s=E+T|0}t[0]=t[0]+s|0,t[1]=t[1]+i|0,t[2]=t[2]+r|0,t[3]=t[3]+o|0,t[4]=t[4]+c|0,t[5]=t[5]+y|0,t[6]=t[6]+u|0,t[7]=t[7]+_|0}_append(n){typeof n=="string"&&(n=O.fromUtf8(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_process(n){let e,t=this._data.sigBytes/64;n?t=Math.ceil(t):t=Math.max((t|0)-this._minBufferSize,0);const s=t*16,i=Math.min(s*4,this._data.sigBytes);if(s){for(let r=0;r<s;r+=16)this._doProcessBlock(this._data.words,r);e=this._data.words.splice(0,s),this._data.sigBytes-=i}return new O(e,i)}}class O{constructor(n,e){A(this,"words");A(this,"sigBytes");n=this.words=n||[],this.sigBytes=e===void 0?n.length*4:e}static fromUtf8(n){const e=unescape(encodeURIComponent(n)),t=e.length,s=[];for(let i=0;i<t;i++)s[i>>>2]|=(e.charCodeAt(i)&255)<<24-i%4*8;return new O(s,t)}toBase64(){const n=[];for(let e=0;e<this.sigBytes;e+=3){const t=this.words[e>>>2]>>>24-e%4*8&255,s=this.words[e+1>>>2]>>>24-(e+1)%4*8&255,i=this.words[e+2>>>2]>>>24-(e+2)%4*8&255,r=t<<16|s<<8|i;for(let o=0;o<4&&e*8+o*6<this.sigBytes*8;o++)n.push(Ot.charAt(r>>>6*(3-o)&63))}return n.join("")}concat(n){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let e=0;e<n.sigBytes;e++){const t=n.words[e>>>2]>>>24-e%4*8&255;this.words[this.sigBytes+e>>>2]|=t<<24-(this.sigBytes+e)%4*8}else for(let e=0;e<n.sigBytes;e+=4)this.words[this.sigBytes+e>>>2]=n.words[e>>>2];this.sigBytes+=n.sigBytes}}function It(a){return new Et().finalize(a).toBase64()}function Ct(a){return It(At(a))}const Rt={trailing:!0};function xt(a,n=25,e={}){if(e={...Rt,...e},!Number.isFinite(n))throw new TypeError("Expected `wait` to be a finite number");let t,s,i=[],r,o;const c=(y,u)=>(r=Ut(a,y,u),r.finally(()=>{if(r=null,e.trailing&&o&&!s){const _=c(y,o);return o=null,_}}),r);return function(...y){return r?(e.trailing&&(o=y),r):new Promise(u=>{const _=!s&&e.leading;clearTimeout(s),s=setTimeout(()=>{s=null;const p=e.leading?t:c(this,y);for(const w of i)w(p);i=[]},n),_?(t=c(this,y),u(t)):i.push(u)})}}async function Ut(a,n,e){return await a.apply(n,e)}const z="_islandPromises",nt=/data-island-uid="([^"]*)"/,Tt=/data-island-uid(="")?(?!="[^"])/g,kt=/data-island-slot="([^"]*)"/g,Lt=/ data-island-slot="([^"]*)"[^>]*>/g,Mt=/^<[^> ]*/;let Dt=1;const Nt=()=>(Dt++).toString();const qt=ct({name:"NuxtIsland",inheritAttrs:!1,props:{name:{type:String,required:!0},lazy:Boolean,props:{type:Object,default:()=>{}},context:{type:Object,default:()=>({})},scopeId:{type:String,default:()=>{}},source:{type:String,default:()=>{}},dangerouslyLoadClientComponents:{type:Boolean,default:!1}},emits:["error"],async setup(a,{slots:n,expose:e,emit:t}){var N,F,P,H,J,q;let s=!1;const i=S(0),r=S(0),o=R(()=>Y),c=S(null),y=$t(),u=ut(),_=R(()=>a.props?Object.fromEntries(Object.entries(a.props).filter(([f])=>!f.startsWith("data-v-"))):{}),p=R(()=>Ct([a.name,_.value,a.context,a.source]).replace(/[-_]/g,"")),w=ht(),D=void 0;let b;const U=globalThis.fetch,E=S(!1);dt(()=>{E.value=!0,i.value++}),ft(()=>{b&&b.dispose()});function T(f,l){const h={};l.props&&(h.props=l.props),l.slots&&(h.slots=l.slots),l.components&&(h.components=l.components),l.head&&(h.head=l.head),u.payload.data[f]={__nuxt_island:{key:f,params:{...a.context,props:a.props?JSON.stringify(a.props):void 0},result:h},...l}}const g={};if(w.vnode.el){const f=(N=pt(u.payload.data[`${a.name}_${p.value}`]))==null?void 0:N.slots;f&&(g.slots=f)}const $=S("");if((F=w.vnode)!=null&&F.el){$.value=((P=yt(w.vnode.el,!0))==null?void 0:P.join(""))||"";const f=`${a.name}_${p.value}`;(H=u.payload.data)[f]||(H[f]={}),u.payload.data[f].html=$.value.replaceAll(new RegExp(`data-island-uid="${((J=$.value.match(nt))==null?void 0:J[1])||""}"`,"g"),'data-island-uid=""')}const m=S(((q=$.value.match(nt))==null?void 0:q[1])||Nt()),k=R(()=>[...$.value.matchAll(kt)].map(f=>f[1])),L=R(()=>{const f=Object.keys(n);let l=$.value;if(a.scopeId&&(l=l.replace(Mt,h=>h+" "+a.scopeId)),!o.value)for(const[h,d]of Object.entries(g.components||{}))l=l.replace(new RegExp(` data-island-uid="${m.value}" data-island-component="${h}"[^>]*>`),B=>B+d.html);return g.slots?l.replaceAll(Lt,(h,d)=>{var B,v;return f.includes(d)?h:h+(((v=(B=g.slots)==null?void 0:B[d])==null?void 0:v.fallback)||"")}):l}),st=gt();async function at(f=!1){var B;const l=`${a.name}_${p.value}`;if(!f&&((B=u.payload.data[l])!=null&&B.html))return u.payload.data[l];const h=`/__nuxt_island/${l}.json`,d=await U(wt(a.source?h:_t(y.app.baseURL??"",h),{...a.context,props:a.props?JSON.stringify(a.props):void 0}));try{const v=await d.json();return T(l,v),v}catch(v){throw d.status!==200?new Error(v.toString(),{cause:d}):v}}async function x(f=!1){var l,h;u[z]||(u[z]={}),(l=u[z])[h=m.value]||(l[h]=at(f).finally(()=>{delete u[z][m.value]}));try{const d=await u[z][m.value];$.value=d.html.replaceAll(Tt,`data-island-uid="${m.value}"`),r.value++,c.value=null,g.slots=d.slots||{},g.components=d.components||{},d!=null&&d.head&&(b?b.patch(d.head):b=st.push(d.head)),vt(()=>{s=!0,i.value++})}catch(d){c.value=d,t("error",d)}}return e({refresh:()=>x(!0)}),mt(a,xt(()=>x(),100),{deep:!0}),!w.vnode.el&&a.lazy?x():(!w.vnode.el||!u.payload.serverRendered)&&await x(),(f,l)=>{var h;return!L.value||c.value?[((h=n.fallback)==null?void 0:h.call(n,{error:c.value}))??M("div")]:[Z([r.value],()=>M(et,{key:r.value},[tt(Bt(L.value||"<div></div>",1))]),l,0),Z([i.value],()=>{var v;const d=[],B=i.value===0||!!(i.value&&!(i.value%2));if(m.value&&L.value&&(a.lazy?s:E.value||(v=w.vnode)!=null&&v.el))for(const I in n)k.value.includes(I)&&d.push(M(bt,{to:`${B?"div":""}[data-island-uid="${m.value}"][data-island-slot="${I}"]`},{default:()=>{var V,K,Q;return((Q=(K=(V=g.slots)==null?void 0:V[I])==null?void 0:K.props)!=null&&Q.length?g.slots[I].props:[{}]).map(it=>{var W;return(W=n[I])==null?void 0:W.call(n,it)})}}));return tt(et,d)},l,1)]}}});export{qt as default};
