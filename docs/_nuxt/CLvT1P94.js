import{b as P,u as C,a as I,g as N,c as S,m as L}from"./ChBTVfoJ.js";import{z as M,A as O,B as n,k as $,i as j,C as D,c as l,o as p,X as H,F as T,r as U,D as V,g as f}from"./DtbfG8E9.js";const X=["type","sizes","srcset"],q=["src","sizes","srcset"],Q=M({__name:"NuxtPicture",props:P,emits:["load","error"],setup(y,{emit:z}){const s=y,g=O(),o=z,_=!1,i=C(),{attrs:x,options:A,modifiers:b}=I(s),v=n(()=>N(s.src)),h=n(()=>["png","webp","gif","svg"].includes(v.value)),u=n(()=>s.legacyFormat?s.legacyFormat:h.value?"png":"jpeg"),m=n(()=>{var t,r;const e=((t=s.format)==null?void 0:t.split(","))||(v.value==="svg"?["svg"]:(r=i.options.format)!=null&&r.length?[...i.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(u.value)&&e.splice(e.indexOf(u.value),1),e.push(u.value),e.map(d=>{const{srcset:E,sizes:w,src:B}=i.getSizes(s.src,{...A.value,sizes:s.sizes||i.options.screens,densities:s.densities,modifiers:{...b.value,format:d}});return{src:B,type:`image/${d}`,sizes:w,srcset:E}}))}),c=n(()=>m.value[m.value.length-1]),k=n(()=>{const e={...s.imgAttrs,"data-nuxt-pic":""};for(const t in g)t in S&&!(t in e)&&(e[t]=g[t]);return e}),a=$(),F=j().isHydrating;return D(()=>{a.value&&(a.value.complete&&F&&(a.value.getAttribute("data-error")?o("error",new Event("error")):o("load",new Event("load"))),a.value.onload=e=>{o("load",e)},a.value.onerror=e=>{o("error",e)},L("nuxt-picture"))}),(e,t)=>(p(),l("picture",null,[(p(!0),l(T,null,U(m.value.slice(0,-1),r=>(p(),l("source",{key:r.src,type:r.type,sizes:r.sizes,srcset:r.srcset},null,8,X))),128)),c.value?(p(),l("img",V({key:0,ref_key:"imgEl",ref:a},{...f(x),...f(_)?{onerror:"this.setAttribute('data-error', 1)"}:{},...k.value},{src:c.value.src,sizes:c.value.sizes,srcset:c.value.srcset}),null,16,q)):H("",!0)]))}});export{Q as default,P as pictureProps};
